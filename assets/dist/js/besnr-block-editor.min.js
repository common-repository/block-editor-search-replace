(()=>{"use strict";var i={};function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,c,s,i=[],l=!0,o=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){o=!0,a=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(o)throw a}}return i}}(e,t)||function(e,t){var n;if(e)return"string"==typeof e?r(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}i.ajaxUrl=besnr.ajax_url,i.pluginDomain=besnr.plugin_domain,i.pluginUrl=besnr.plugin_url,i.ajaxNonce=besnr.ajax_nonce,i.ajaxRequest=function(e,t,n,r){jQuery.ajax({method:"post",url:i.ajaxUrl,data:jQuery.extend({action:e,_wpnonce:i.ajaxNonce},n),beforeSend:function(){return i.beforeSendCallback(t)},success:function(e){return r(JSON.parse(e)[0])},complete:function(){return i.completeCallback(t)},error:function(){return i.errorCallback(t)}})},i.resetSettings=function(e){e.preventDefault();var t=jQuery(e.target).closest(".besnr-admin");window.confirm("Are you sure you want to reset all the options to their defaults?")&&i.ajaxRequest("besnr_reset_options_default",t,"",function(e){e&&!1===e.success||(i.outputCallback(t,e.status,e.message),jQuery("html, body").animate({scrollTop:0},"fast"),setTimeout(function(){return document.location.reload(!0)},1e3))})},i.highlightSearchText=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",n=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),e={current_post_id:n.find('input[name="besnr-current-post-id"]').val(),search_phrase:n.find('input[name="besnr-search-phrase"]').val(),is_highlighted:n.find('input[name="besnr-highlight-search"]:checked').length,is_case_sensitive:n.find('input[name="besnr-case-sensitive"]:checked').length,is_classic_editor:n.find('input[name="besnr-classic-editor"]').val()};i.ajaxRequest("besnr_highlight_search_text",n,e,function(e){i.reloadEditor(e,n,t)})},i.doSearchReplace=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",n=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),e={current_post_id:n.find('input[name="besnr-current-post-id"]').val(),search_phrase:n.find('input[name="besnr-search-phrase"]').val(),replace_with_phrase:n.find('input[name="besnr-replace-with-phrase"]').val(),is_highlighted:n.find('input[name="besnr-highlight-search"]:checked').length,is_case_sensitive:n.find('input[name="besnr-case-sensitive"]:checked').length,is_classic_editor:n.find('input[name="besnr-classic-editor"]').val()};i.ajaxRequest("besnr_do_search_and_replace",n,e,function(e){i.reloadEditor(e,n,t)})},i.cleanAllHighlightTags=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"classic",n=(e.preventDefault(),jQuery(e.target).closest(".besnr-admin")),e={current_post_id:n.find('input[name="besnr-current-post-id"]').val(),is_classic_editor:n.find('input[name="besnr-classic-editor"]').val()};i.ajaxRequest("besnr_clean_tags",n,e,function(e){i.reloadEditor(e,n,t),n.find('input[name="besnr-search-phrase"]').val(""),n.find('input[name="besnr-replace-with-phrase"]').val("")})},i.reloadEditor=function(e,t,n){var r={current_post_id:t.find('input[name="besnr-current-post-id"]').val(),is_classic_editor:t.find('input[name="besnr-classic-editor"]').val()};0!==e.status&&1!==e.status||i.outputCallback(t,e.status,e.message),i.ajaxRequest("besnr_update_editor_contents",t,r,function(e){var t;e&&!1===e.success||2!==e.status||(e=JSON.parse(e.message),"classic"===n?(t=jQuery("<style/>").html("besnr-highlight { background-color: #5accf2; padding: 3px; }"),jQuery("#content_ifr").contents().find("head").append(t),jQuery("#content_ifr").contents().find("body").empty().html(e)):(t=window.wp).data.dispatch("core/block-editor").resetBlocks(t.blocks.parse(e)))})},i.beforeSendCallback=function(e){e.find(".besnr-loading-bar").show()},i.completeCallback=function(e){e.find(".besnr-loading-bar").hide()},i.errorCallback=function(e){e=e.find(".besnr-output").empty();e.addClass("besnr-output-active besnr-output-active-error"),e.html("Internal Server Error! Contact your hosting provider and access your logs to learn more about what is causing the error.")},i.outputCallback=function(e,t,n){e=e.find(".besnr-output").empty();e.removeClass("besnr-output-active-success besnr-output-active-error").addClass("besnr-output-active-"+(1===t?"success":"error")),e.addClass("besnr-output-active").show().html(n)},jQuery,jQuery(document).on("click",'button[name="besnr-reset-button"]',i.resetSettings),1==jQuery('input[name="besnr-classic-editor"]').val()&&(jQuery(document).on("blur",'input[name="besnr-search-phrase"]',i.highlightSearchText),jQuery(document).on("click",'button[name="besnr-search-replace"]',i.doSearchReplace),jQuery(document).on("click",'button[name="besnr-clean-tags"]',i.cleanAllHighlightTags));var o=wp.i18n.__,u=wp.element.useState,p=wp.components.Button,e=wp.plugins.registerPlugin,d=wp.editPost.PluginDocumentSettingPanel,t=wp.data,h=t.useSelect;t.select,e("block-editor-search-replace-plugin",{render:function(){var e=h(function(e){return{postType:e("core/editor").getCurrentPostType(),postId:e("core/editor").getCurrentPostId()}}),t=e.postType,e=e.postId,n=l(u(!0),2),r=n[0],a=n[1],n=l(u(!0),2),c=n[0],s=n[1];return React.createElement(d,{name:"block-editor-search-replace",title:"Search & Replace",className:"block-editor-search-replace"},React.createElement("div",{class:"besnr-admin"},React.createElement("div",{class:"besnr-form-ui"},React.createElement("p",null,o("The search and replace plugin will help you find any text inside the Block Editor content area and replace with another one.","block-editor-search-replace")),React.createElement("form",{id:"besnr-form",name:"besnr-form",type:"post"},React.createElement("div",{class:"besnr-loading-bar"}),React.createElement("div",{id:"besnr-output",class:"besnr-output"}),React.createElement("input",{type:"hidden",id:"besnr-current-post-type",name:"besnr-current-post-type",value:t}),React.createElement("input",{type:"hidden",id:"besnr-current-post-id",name:"besnr-current-post-id",value:e}),React.createElement("input",{type:"hidden",id:"besnr-classic-editor",name:"besnr-classic-editor",value:"0"}),React.createElement("div",{class:"search-replace-group"},React.createElement("p",null,React.createElement("label",{for:"besnr-highlight-search"},React.createElement("input",{type:"checkbox",id:"besnr-highlight-search",name:"besnr-highlight-search",checked:r,onChange:function(){return a(!r)}}),React.createElement("span",null,o("Highlight text on search","block-editor-search-replace")))),React.createElement("p",null,React.createElement("label",{for:"besnr-case-sensitive"},React.createElement("input",{type:"checkbox",id:"besnr-case-sensitive",name:"besnr-case-sensitive",checked:c,onChange:function(){return s(!c)}}),React.createElement("span",null,o("Case sensitive search & replace","block-editor-search-replace")))),React.createElement("p",null,React.createElement("input",{type:"text",id:"besnr-search-phrase",name:"besnr-search-phrase",class:"besnr-search-phrase",placeholder:o("Enter you search phrase...","block-editor-search-replace"),onBlur:function(e){i.highlightSearchText(e,"block")}})),React.createElement("p",null,React.createElement("input",{type:"text",id:"besnr-replace-with-phrase",name:"besnr-replace-with-phrase",class:"besnr-replace-with-phrase",placeholder:o("Enter your replace with phrase...","block-editor-search-replace")})),React.createElement("p",{class:"button-group"},React.createElement(p,{id:"besnr-search-replace",name:"besnr-search-replace",className:"button button-primary besnr-search-replace",onClick:function(e){i.doSearchReplace(e,"block")}},React.createElement("i",{class:"dashicons dashicons-randomize"}),o("Replace","block-editor-search-replace")),React.createElement(p,{id:"besnr-clean-tags",name:"besnr-clean-tags",className:"button besnr-clean-tagse",onClick:function(e){i.cleanAllHighlightTags(e,"block")}},o("Reset","block-editor-search-replace"))))))))}})})();